FROM openjdk:17-alpine

EXPOSE 8080

ARG SPRING_PROFILE
ARG POSTGRES_DB
ARG POSTGRES_HOST
ARG POSTGRES_PORT
ARG POSTGRES_USERNAME
ARG POSTGRES_PASSWORD
ARG AWS_ACCESS_KEY
ARG AWS_SECRET_KEY
ARG AWS_REGION
ARG AWS_SQS_ENDPOINT
ARG QUEUE_PEDIDO_GERADO
ARG QUEUE_RETORNO_PAGAMENTO

ENV SPRING_PROFILE=${SPRING_PROFILE}
ENV POSTGRES_DB=${POSTGRES_DB}
ENV POSTGRES_HOST=${POSTGRES_HOST}
ENV POSTGRES_PORT=${POSTGRES_PORT}
ENV POSTGRES_USERNAME=${POSTGRES_USERNAME}
ENV POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
ENV AWS_ACCESS_KEY=${AWS_ACCESS_KEY}
ENV AWS_SECRET_KEY=${AWS_SECRET_KEY}
ENV AWS_REGION=${AWS_REGION}
ENV AWS_SQS_ENDPOINT=${AWS_SQS_ENDPOINT}
ENV QUEUE_PEDIDO_GERADO=${QUEUE_PEDIDO_GERADO}
ENV QUEUE_RETORNO_PAGAMENTO=${QUEUE_RETORNO_PAGAMENTO}

COPY ../target/pagamento-valhalla-kitchen-0.0.1.jar /usr/src/myapp/app.jar

WORKDIR /usr/src/myapp

ENTRYPOINT java -Dspring.profiles.active="$SPRING_PROFILE" -jar app.jar
