FROM openjdk:17-alpine

EXPOSE 8080

ARG DB_USERNAME
ARG DB_PASSWORD
ARG SPRING_PROFILE
ARG POSTGRES_DB
ARG POSTGRES_HOST
ARG AWS_ACCESS_KEY
ARG AWS_SECRET_KEY
ARG AWS_REGION

ENV DB_USERNAME=${DB_USERNAME}
ENV DB_PASSWORD=${DB_PASSWORD}
ENV SPRING_PROFILE=${SPRING_PROFILE}
ENV POSTGRES_DB=${POSTGRES_DB}
ENV POSTGRES_HOST=${POSTGRES_HOST}
ENV AWS_ACCESS_KEY=${AWS_ACCESS_KEY}
ENV AWS_SECRET_KEY=${AWS_SECRET_KEY}
ENV AWS_REGION=${AWS_REGION}

COPY ../target/pagamento-valhalla-kitchen-0.0.1.jar /usr/src/myapp/app.jar

WORKDIR /usr/src/myapp

ENTRYPOINT java -Dspring.profiles.active="$SPRING_PROFILE" -jar app.jar
